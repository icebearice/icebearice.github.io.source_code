### 操作系统与Linux综合学习

#### 内核

内核 Kernel 是一个用来管理软件发出的数据I/O要求的计算机程序，将这些要求转译为数据处理的指令并交由中央处理器（CPU）及计算机中其他电子组件进行处理，是现在操作系统中最基本的部分。本来计算机中的应用程序是可以直接地调入计算机中执行的，但是直接对硬件进行操作是非常复杂的。所以内核通常提供一种硬件抽象的方法，来完成这些操作，所以从某种程度上来说，内核也不是必要的组成部分。

简而言之，内核控制计算机资源，提供程序的运行环境

##### 内核分类

分为宏内核和微内核两大架构，宏内核与微内核之间，还有一种混合内核；微内核之下还有一种极端的设计方式，成为外内核

##### 宏内核

宏内核结构在硬件的基础上，定义了一个高阶的抽象接口，应用一组原语（或者叫系统调用system call）来实现操作系统的功能，例如进程管理，文件系统和存储管理等等，这些功能由多个运行在内核态的模块来完成。

尽管每一个模块都是单独地服务这些操作，内核代码是高度集成的，一个宏内核相当于是一个二进制的大应用程序，模块间的通讯是通过直接调用其他模块中的函数实现的，而不是通过消息传递，系统服务的实现以及系统的基本操作规则是耦合的。因此一个使某模块功能瘫痪的bug会使整个系统需要崩溃重启

然而，如果开发顺利，单内核结构就可以从运行效率上得到好处

常见的宏内核有Linux和Unix

##### 微内核

微内核结构是由一个非常简单的硬件抽象和一组比较关键的原语或系统调用组成；这些原语，仅仅包括了创建一个系统必须的几个部分；如线程管理、地址空间和行程间通讯（进程或线程）

微内核的目标是将系统服务的实现和系统的基本操作规则分离开来。一个服务组件的失效并不会导致整个系统的崩溃，内核需要做的，仅仅是重启这个组件，而不影响其他部分。

然而，微内核相比单内核可能有一点运行效率上的差别，在调用模块的时候，宏内核是采用的是方法间的调用，微内核采用的是组件的调用

微内核经常被用于机器人和医疗器械的嵌入式设计中

宏内核和微内核的共同点，就是他们都有创建一个系统的必要组成部分：线程管理、地址空间和行程间通讯

##### 混合内核

混合内核的设计理念来自微内核，只不过它让一些微核结构运行在用户空间的代码运行在内核空间，让内核的运行效率更高

##### 外内核

外内核系统，也被称为纵向结构操作系统，是一种比较极端的设计方法

它的设计理念是让用户程序的设计者来决定硬件接口的设计。外内核本身非常的小，它通常只负责系统保护和系统资源复用相关的服务

传统的内核设计都对硬件作了抽象，把硬件资源或设备驱动程序都隐藏在硬件抽象层下。比方说，在这些系统中，如果分配一段物理存储，应用程序并不知道它的实际位置。

而外核的目标就是让应用程序直接请求一块特定的物理孔家你、一块待定的磁盘块等等。系统本身只保证被请求的资源当前是空闲的，应用程序就允许直接访问它。既然外核系统只提供了比较低级的硬件操作，而没有像其他系统一样提供高级的硬件抽象，那么就需要增加额外的运行库支持，这些运行库运行在外核之上，给用户程序提供了完成的功能。

理论上，这种设计可以让各种操作系统运行在一个外核之上，如Windows和Unix。并且设计人员可以根据运行效率调整系统的各部分功能。

现在，外核设计还停留在研究阶段，没有任何一个商业系统采用了这种设计。几种概念上的操作系统正在被开发，如[剑桥大学](https://wiwiwiki.kfd.me/wiki/%E5%89%91%E6%A1%A5%E5%A4%A7%E5%AD%A6)的Nemesis，格拉斯哥大学的Citrix系统和瑞士计算机科学院的一套系统。[麻省理工学院](https://wiwiwiki.kfd.me/wiki/%E9%BA%BB%E7%9C%81%E7%90%86%E5%B7%A5%E5%AD%A6%E9%99%A2)也在进行着这类研究。PID简介

进程标识符 process identifier，简称进程ID process ID，PID，是大多数操作系统的内核用于唯一标识进程的一个数值。这一数值可以作为许多函数调用的参数，以使调整进程优先级、杀死进程之类的进程控制行为成为可能

#### Pstree 命令

pstree命令是用于查看进程树之间的关系，即哪个进程是父进程，哪个进程是子进程，可以清楚的看出进程与进程之间的关系

**几个重要的参数：**

-A：各进程树之间的连接以ASCII码字符来连接

-U：各进程树之间的连接以UTF8码字符来链接

-p：同时列出每个进程的PID

-u：同时列出每个进程的所属账号名称

![1564654452444](C:\Users\2010104-0288\AppData\Roaming\Typora\typora-user-images\1564654452444.png)

![1564654412033](C:\Users\2010104-0288\AppData\Roaming\Typora\typora-user-images\1564654412033.png)

#### Supervisor学习

##### 简介

Supervisor是基于Python开发的一个client/server服务，是Linux/Unix系统下的一个进程管理工具，不支持Windows系统，可以很方便的监听、启动、停止、重启一个或多个进程。此外，若有进程无法在其运行崩溃之后自行重新启动，Supervisor将会重新启动 相关进程 作为 子进程，并自动的加载进程相关配置

supervisor安装完成后会生成三个执行程序：supervisortd、supervisorctl、echo_supervisord_conf，分别是supervisor的守护进程服务（用于接收进程管理命令）、客户端（用于和守护进程通信，发送管理进程的指令）、生成初始配置文件程序。

相关blog与官方文档

<https://blog.csdn.net/xyang81/article/details/51555473>

<http://supervisord.org/introduction.html>

K8S Docker LISP ipvs